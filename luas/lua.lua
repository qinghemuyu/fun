---QQIconCode-------------
-------mian
-- QQIconCode = 1348984838
if QQIconCode == nil then
    print("请先登录")
    return
end
local function mainrunQInEmax()
    client.Command("echo \" QInEmax已加载---" .. QQIconCode ..
                       "--祝你游玩愉快~+-+\"", true)
    client.Command("echo \" Code by 清河 QQ1348984838 \"", true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◆◆◇◇◇◇◇◇◇◇◇◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◆◆◆◆◆◆◆◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◆◆◆◇◇◇◇◇◇◇◇◆◇◇◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◆◆◆◇◆◆◆◆◆◆◆◆◆◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◆◆◆◆◆◆◆◆◆◆◆◆◆◇◆◆◆◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◆◆◆◇◆◆◆◆◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◆◇◇◇◇◇◇◇◇◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◆◆◇◇◇◇◇◇◇◆◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◇◇◇◇◆◆◆◆◆◆◆◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◇◇◇◆◆◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◆◇◇◇◇◇◆◆◇◇◆◆◆◆◆◇◇◇◇◇◇◆◆◇◇◇◇◇◇◇◆◆◇◇◇◇◇◇◆◆◆◆◆◆◆◆◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◆◆◆◇◇◇◆◆◇◇◇◆◆◆◆◆◆◆◆◆◆◆◆◆◇◇◇◇◇◇◆◆◆◆◇◇◆◆◇◆◆◆◆◆◆◆◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◆◆◆◇◇◆◆◆◆◆◆◆◆◆◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◆◆◆◆◇◆◆◇◆◇◇◇◆◆◆◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◆◆◇◆◆◆◆◆◆◇◇◇◇◇◇◇◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◆◇◇◆◇◇◇◆◆◇◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◆◆◇◆◆◇◇◆◆◆◆◆◆◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◆◇◆◆◇◇◆◇◇◇◆◆◇◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◆◆◇◇◇◆◆◆◆◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◇◆◆◆◆◆◆◆◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◆◆◇◇◇◇◆◇◇◇◇◇◆◇◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◇◆◆◆◆◆◆◆◆◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◆◆◇◇◇◇◆◆◆◆◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◇◆◆◇◇◇◇◇◇◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◆◆◇◇◇◇◆◆◆◆◆◆◆◇◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◇◇◆◇◇◇◇◇◇◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◆◆◇◇◇◇◇◆◇◇◇◆◆◆◇◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◆◇◇◆◆◇◇◇◇◇◆◆◆◆◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◆◇◇◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◆◆◆◆◆◇◇◇◇◇◆◆◆◇◇◇◇◇◆◇◇◇◇◇◇◇◇◇◇◇◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◆◆◆◆◇◇◇◇◇◆◇◇◇◇◇◇◇◆◇◇◇◇◇◇◇◇◇◇◇◇◆◆◆◇◇◇◇◇◇◇◇◇◆◆◇◇◇◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◆◆◇◇◇◇◇◇◆◇◇◇◆◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◆◆◆◇◇◇◇◇◇◇◇◇◆◆◆◆◆◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◆◆◇◇◇◇◇◆◆◇◇◇◇◆◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◇◇◇◇◇◇◇◇◇◇◆◆◆◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◇◇◇◇◆◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◇◇◇◇◇◆◇◇◇◇◇◇◆◆◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◆◆◇◇◇◇◇◇◇◇ \"",
        true)
    client.Command(
        "echo \" ◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇ \"",
        true)
end
mainrunQInEmax()
local iconPng = http.Get("http://q1.qlogo.cn/g?b=qq&nk=" .. QQIconCode ..
                             "&s=100&t=")
local QingheQInEMax = gui.Window("QingheQInEMax",
                                 "QInEmax--" .. client.GetConVar('name'), 100,
                                 200, 250, 0)
local QInEMaxSetTag = ffi.cast('int(__fastcall*)(const char*, const char*)',
                               mem.FindPattern('engine.dll',
                                               '53 56 57 8B DA 8B F9 FF 15'))
local QInEMaxlast = nil

local QInEMaxSetTagfun = function(v)
    if v ~= QInEMaxlast then
        QInEMaxSetTag(v, "")
        QInEMaxlast = v
    end
end
local x, y = draw.GetScreenSize();
local w, h = draw.GetScreenSize()
local aw_menu = gui.Reference("MENU");
local userboxip = gui.Checkbox(QingheQInEMax, "userboxip",
                               "当前用户：" .. QQIconCode, 1)
-- local QingheQInEMax=gui.Groupbox(gui.Reference("Ragebot", "Anti-aim"), "合法AA", 100, 100)
-- local menuQInEKey=gui.Keybox( QingheQInEMax, "menuQInEKey", "设置QInE显隐按键", 36 )
local QingheQInEMaxMOde = gui.Combobox(QingheQInEMax, "QingheQInEMaxMOde",
                                       "Lua运行模式", "摇头", "合法")
local masg = gui.Checkbox(QingheQInEMax, "masg", "伤害日志", true);
local masgsay = gui.Checkbox(QingheQInEMax, "masgsay",
                             "全局聊天输出伤害日志", false)
masg:SetDescription("关闭则显示另一种展示方式")
---

local autowallkeygui = gui.Window("autowallkeygui", "AutoWall键位绑定", 900,
                                  200, 250, 0)

local autowallkeybind = gui.Keybox(autowallkeygui, "autowallkeybind",
                                   "键位绑定", 0)

autowallkeybind:SetDescription(
    "触发方式按下--NMB爷懒得写按住触发了^ ^")
---
local visuals = gui.Checkbox(QingheQInEMax, "visuals", "视觉", true)

local QInEmaxvisuals = gui.Window("QInEmaxvisuals", "视觉", 900, 200, 250, 0)

local QInEMaxWatermark = gui.Checkbox(QInEmaxvisuals, "QInEMaxWatermark",
                                      "水印", true)

local indfdswbox = gui.Checkbox(QInEmaxvisuals, "indfdsw", "状态指示器", 1)

local Qhweaponbox = gui.Checkbox(QInEmaxvisuals, "Qhweapon", "武器指示器",
                                 1)

local CHECKBOX_ALL = gui.Checkbox(QInEmaxvisuals, "IndicatorsALL",
                                  "AA指示器", 1)

local QInEmaxAAIndicatorsCSS = gui.Combobox(QInEmaxvisuals,
                                            "QInEmaxAAIndicatorsCSS",
                                            "AA指示器样式", "<", "()",
                                            "丨")
---
local QInEmaxAAkey = gui.Checkbox(QingheQInEMax, "QInEmaxAAkey", "Anti-Aim",
                                  true)
local chk_dynfov = gui.Checkbox(QingheQInEMax, "chk_dynfov", "动态RageFOV",
                                false)
local dynfovUI = gui.Window("dynfovUI", "动态RageFOV", 400, 400, 160, 0)
local QInEmaxAA = gui.Window("QInEmaxAA", "Anti AIM", 1500, 200, 200, 0)
local QInEmaxAAjitter = gui.Checkbox(QInEmaxAA, "QInEmaxAAjitter", "抖动",
                                     false)
local KEYBOX_INVERTER = gui.Keybox(QInEmaxAA, "inverter", "切换方向", 70)
local KEYBOX_ONUSEKEY = gui.Keybox(QInEmaxAA, "onuse", "切换合法AA", 69)
local KEYBOX_start = gui.Combobox(QInEmaxAA, "onuse.start",
                                  "切换合法AA触发方式", "按住",
                                  "按下")
local KEYBOX_LEFTKEY = gui.Keybox(QInEmaxAA, "left", "左", 90)
local KEYBOX_RIGHTKEY = gui.Keybox(QInEmaxAA, "right", "右", 67)
local KEYBOX_BackKEY = gui.Keybox(QInEmaxAA, "Back", "背身", 88)
local Checkbox_KILLEVENT = gui.Checkbox(QInEmaxAA, "killevent",
                                        "击杀自动藏头", false)
local Checkbox_SHOTeve = gui.Checkbox(QInEmaxAA, "shoteve",
                                      "开枪切换AA", false)
-- local KEYBOX_shotstat = gui.Combobox(QInEmaxAA, "shot.start", "触发方式",
--                                      "其他人开枪", "自己开枪")
KEYBOX_INVERTER:SetDescription("按键绑定")
local antipeekeve = gui.Checkbox(QInEmaxAA, "antipeekeve", "Anti Peek", false)
local dongtaifl = gui.Checkbox(QInEmaxAA, "dongtaifl", "动态FL", false)
local flmode =
    gui.Combobox(QInEmaxAA, "flmode", "假卡模式", "官匹", "HVH")

local customtag = gui.Checkbox(QingheQInEMax, "customtag", "组名", true)
local customtaglist = gui.Listbox(QingheQInEMax, "customtaglist", 50, '默认',
                                  '时间', '延迟', 'CPU&RAM', '自定义')
local divccQInE = gui.Editbox(QingheQInEMax, "divccQInE", "QInEmaxCC")
local dicvvQInEBtt = gui.Button(QingheQInEMax, "应用自定义组名",
                                function() customtaglist:SetValue(4) end)
local mindmgcover = gui.Checkbox(QingheQInEMax, "mindmgcover",
                                 "伤害&命中覆盖", false)

local weaponWindow = gui.Window("weaponWindow", "伤害&命中覆盖", 400, 500,
                                265, 1)

local QInerunmode = false
local lowBpcmode = gui.Button(QingheQInEMax, "切换至低配模式", function()
    gui.SetValue("rbot.hitscan.maxprocessingtime", 45)
    gui.SetValue("QInEmaxvisuals.indfdsw", false)
    gui.SetValue("QInEmaxvisuals.Qhweapon", false)
    gui.SetValue("QingheQInEMax.visuals", false)
    gui.SetValue("QingheQInEMax.chk_dynfov", false)
    gui.SetValue("QInEmaxvisuals.QInEMaxWatermark", false)
    client.Command("toggleconsole", true)
    client.Command("echo \" 当前模式低调行事 \"", true)
    QInerunmode = true
end)
local godPcmode = gui.Button(QingheQInEMax, "切换至高配模式", function()
    gui.SetValue("rbot.hitscan.maxprocessingtime", 75)
    gui.SetValue("QInEmaxvisuals.indfdsw", true)
    gui.SetValue("QInEmaxvisuals.Qhweapon", true)
    gui.SetValue("QingheQInEMax.visuals", true)
    gui.SetValue("QingheQInEMax.chk_dynfov", true)
    gui.SetValue("QInEmaxvisuals.QInEMaxWatermark", true)
    client.Command("toggleconsole", true)
    client.Command("echo \" 当前模式火力全开 \"", true)
    QInerunmode = false
end)
local UnloadScriptdddd = gui.Button(QingheQInEMax, "退出QInEMax", function()
    panorama.RunScript([[
        SteamOverlayAPI.OpenExternalBrowserURL("https://www.bilibili.com/video/BV12x411E7xp?from=search&seid=5982703104507369952");
                                                                  ]])
    -- file.Delete( GetScriptName() )
    gui.Command("lua.reset")
end)
local old_time = 0

local cconeQinghe = {
    "      Q", "     QI", "    QIn", "   QInE", "  QInEC", " QInECC",
    "QInECC✈", "InECC✈ ", "nECC✈  ", "ECC✈   ", "CC✈    ",
    "C✈     ", "✈      ", "       "
}

callbacks.Register("Draw", function()
    Checkbox_KILLEVENT:SetDisabled(true)
    Checkbox_SHOTeve:SetDisabled(true)
    QInEmaxAAjitter:SetDisabled(true)
    customtaglist:SetValue(0)
    customtag:SetValue(true)
    customtag:SetDisabled(true)
    dongtaifl:SetDisabled(true)
    antipeekeve:SetDisabled(true)
    QInEMaxWatermark:SetValue(true)
    dicvvQInEBtt:SetDisabled(true)
    lowBpcmode:SetDisabled(true)
    godPcmode:SetDisabled(true)
    if QInEmaxAAkey:GetValue() then
        QInEmaxAA:SetActive(aw_menu:IsActive())
    else
        QInEmaxAA:SetActive(false)
    end
    if mindmgcover:GetValue() then
        weaponWindow:SetActive(aw_menu:IsActive())
    else
        weaponWindow:SetActive(false)
    end
    if visuals:GetValue() then
        QInEmaxvisuals:SetActive(aw_menu:IsActive())
    else
        QInEmaxvisuals:SetActive(false)
    end
    if chk_dynfov:GetValue() then
        dynfovUI:SetActive(aw_menu:IsActive())
    else
        gui.SetValue("rbot.aim.target.fov", 180)
        dynfovUI:SetActive(false)
    end
    QingheQInEMax:SetActive(aw_menu:IsActive())
end)

local font = draw.CreateFont('Verdana', 35, 100)
-- 水印
local FONT = draw.CreateFont("Verdana", 30, 400)
callbacks.Register("Draw", function()
    -- draw.SetFont(FONT)
    local r = math.floor(math.sin(globals.RealTime() * 1) * 100 + 127);
    local g = math.floor(math.sin(globals.RealTime() * 1 + 2) * 100 + 127);
    local b = math.floor(math.sin(globals.RealTime() * 1 + 4) * 100 + 127);
    local a = math.floor(math.sin(globals.RealTime() * 1) * 100 + 127);
    draw.Color(255, 255, 255, 255)
    draw.Text(5, 5, "Code -by ")
    draw.Color(r, g, b, a)
    draw.Text(60, 5, "Qinghe")
    draw.SetFont(FONT)
    draw.Color(r, g, b, a);
    if QInEMaxWatermark:GetValue() then
        draw.TextShadow(0, y - 200, "Cfg by Qinghe")
    end

end)
--------0-------------动态FOV
------------------------伤害覆盖

local midhitkeybind = gui.Keybox(weaponWindow, "midhitkeybind",
                                 "最低命中覆盖", 20)
local middmgkeybind = gui.Keybox(weaponWindow, "middmgkeybind",
                                 "最低伤害覆盖", 20)
local weaponCombobox = gui.Listbox(weaponWindow, "weaponWindow", 50, "手枪",
                                   "沙鹰&R8", "冲锋枪", "步枪",
                                   "霰弹枪", "鸟狙", "连狙", "大狙",
                                   "机枪")
local pistoldefhit = gui.Slider(weaponWindow, "pistoldefdmg",
                                "手枪默认命中率", 14, 1, 100)
local pistoldefminhit = gui.Slider(weaponWindow, "pistoldefminhit",
                                   "手枪最低命中率", 8, 1, 100)
local hpistoldefhit = gui.Slider(weaponWindow, "hpistoldefhit",
                                 "沙鹰&R8默认命中率", 58, 1, 100)
local hpistoldefminhit = gui.Slider(weaponWindow, "hpistoldefminhit",
                                    "沙鹰&R8最低命中率", 8, 1, 100)
local smgdefhit = gui.Slider(weaponWindow, "smgdefhit",
                             "冲锋枪默认命中率", 12, 1, 100)
local smgdefminhit = gui.Slider(weaponWindow, "smgdefminhit",
                                "冲锋枪最低命中率", 8, 1, 100)
local rifledefhit = gui.Slider(weaponWindow, "rifledefhit",
                               "步枪默认命中率", 11, 1, 100)
local rifledefminhit = gui.Slider(weaponWindow, "rifledefminhit",
                                  "步枪最低命中率", 8, 1, 100)
local shotgundefhit = gui.Slider(weaponWindow, "shotgundefhit",
                                 "霰弹枪默认命中率", 29, 1, 100)
local shotgundefminhit = gui.Slider(weaponWindow, "shotgundefminhit",
                                    "霰弹枪最低命中率", 8, 1, 100)
local scoutdefhit = gui.Slider(weaponWindow, "scoutdefhit",
                               "鸟狙默认命中率", 71, 1, 100)
local scoutdefminhit = gui.Slider(weaponWindow, "scoutdefminhit",
                                  "鸟狙最低命中率", 8, 1, 100)
local asniperdefhit = gui.Slider(weaponWindow, "asniperdefhit",
                                 "连狙默认命中率", 53, 1, 100)
local asniperdefminhit = gui.Slider(weaponWindow, "asniperdefminhit",
                                    "连狙最低命中率", 8, 1, 100)
local sniperdefhit = gui.Slider(weaponWindow, "sniperdefhit",
                                "大狙默认命中率", 69, 1, 100)
local sniperdefminhit = gui.Slider(weaponWindow, "sniperdefminhit",
                                   "大狙最低命中率", 8, 1, 100)
local lmgdefhit = gui.Slider(weaponWindow, "lmgdefhit", "机枪默认命中率",
                             16, 1, 100)
local lmgdefminhit = gui.Slider(weaponWindow, "lmgdefminhit",
                                "机枪最低命中率", 8, 1, 100)
local pistoldefdmg = gui.Slider(weaponWindow, "pistoldefdmg",
                                "手枪默认伤害", 13, 1, 130)
local pistoldefmindmg = gui.Slider(weaponWindow, "pistoldefmindmg",
                                   "手枪最低伤害", 8, 1, 130)
local hpistoldefdmg = gui.Slider(weaponWindow, "hpistoldefdmg",
                                 "沙鹰&R8默认伤害", 37, 1, 130)
local hpistoldefmindmg = gui.Slider(weaponWindow, "hpistoldefmindmg",
                                    "沙鹰&R8最低伤害", 8, 1, 130)
local smgdefdmg = gui.Slider(weaponWindow, "smgdefdmg", "冲锋枪默认伤害",
                             6, 1, 130)
local smgdefmindmg = gui.Slider(weaponWindow, "smgdefmindmg",
                                "冲锋枪最低伤害", 8, 1, 130)
local rifledefdmg = gui.Slider(weaponWindow, "rifledefdmg",
                               "步枪默认伤害", 21, 1, 130)
local rifledefmindmg = gui.Slider(weaponWindow, "rifledefmindmg",
                                  "步枪最低伤害", 8, 1, 130)
local shotgundefdmg = gui.Slider(weaponWindow, "shotgundefdmg",
                                 "霰弹枪默认伤害", 12, 1, 130)
local shotgundefmindmg = gui.Slider(weaponWindow, "shotgundefmindmg",
                                    "霰弹枪最低伤害", 8, 1, 130)
local scoutdefdmg = gui.Slider(weaponWindow, "scoutdefdmg",
                               "鸟狙默认伤害", 88, 1, 130)
local scoutdefmindmg = gui.Slider(weaponWindow, "scoutdefmindmg",
                                  "鸟狙最低伤害", 8, 1, 130)
local asniperdefdmg = gui.Slider(weaponWindow, "asniperdefdmg",
                                 "连狙默认伤害", 51, 1, 130)
local asniperdefmindmg = gui.Slider(weaponWindow, "asniperdefmindmg",
                                    "连狙最低伤害", 8, 1, 130)
local sniperdefdmg = gui.Slider(weaponWindow, "sniperdefdmg",
                                "大狙默认伤害", 98, 1, 130)
local sniperdefmindmg = gui.Slider(weaponWindow, "sniperdefmindmg",
                                   "大狙最低伤害", 8, 1, 130)
local lmgdefdmg = gui.Slider(weaponWindow, "lmgdefdmg", "机枪默认伤害", 5,
                             1, 130)
local lmgdefmindmg = gui.Slider(weaponWindow, "lmgdefmindmg",
                                "机枪最低伤害", 8, 1, 130)

callbacks.Register("Draw", function()
    if input.IsButtonPressed(midhitkeybind:GetValue()) then
        hitstatusBoolean = not hitstatusBoolean
    end
    if input.IsButtonPressed(middmgkeybind:GetValue()) then
        dmgstatusBoolean = not dmgstatusBoolean
    end
    if hitstatusBoolean then
        draw.Color(190, 46, 221)
        draw.Text(w / 2 - 55, h / 2.05 - 29, "MIN:HIT&DMG") -- 最低伤害指示器
        gui.SetValue("rbot.accuracy.weapon.pistol.hitchance",
                     pistoldefminhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.hpistol.hitchance",
                     hpistoldefminhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.smg.hitchance",
                     smgdefminhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.rifle.hitchance",
                     rifledefminhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.shotgun.hitchance",
                     shotgundefminhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.scout.hitchance",
                     scoutdefminhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.asniper.hitchance",
                     asniperdefminhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.sniper.hitchance",
                     sniperdefminhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.lmg.hitchance",
                     lmgdefminhit:GetValue())
    else
        gui.SetValue("rbot.accuracy.weapon.pistol.hitchance",
                     pistoldefhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.hpistol.hitchance",
                     hpistoldefhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.smg.hitchance", smgdefhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.rifle.hitchance",
                     rifledefhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.shotgun.hitchance",
                     shotgundefhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.scout.hitchance",
                     scoutdefhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.asniper.hitchance",
                     asniperdefhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.sniper.hitchance",
                     sniperdefhit:GetValue())
        gui.SetValue("rbot.accuracy.weapon.lmg.hitchance", lmgdefhit:GetValue())
    end
    if dmgstatusBoolean then
        gui.SetValue("rbot.accuracy.weapon.pistol.mindmg",
                     pistoldefmindmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.hpistol.mindmg",
                     hpistoldefmindmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.smg.mindmg", smgdefmindmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.rifle.mindmg",
                     rifledefmindmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.shotgun.mindmg",
                     shotgundefmindmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.scout.mindmg",
                     scoutdefmindmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.asniper.mindmg",
                     asniperdefmindmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.sniper.mindmg",
                     sniperdefmindmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.lmg.mindmg", lmgdefmindmg:GetValue())
    else
        gui.SetValue("rbot.accuracy.weapon.pistol.mindmg",
                     pistoldefdmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.hpistol.mindmg",
                     hpistoldefdmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.smg.mindmg", smgdefdmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.rifle.mindmg", rifledefdmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.shotgun.mindmg",
                     shotgundefdmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.scout.mindmg", scoutdefdmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.asniper.mindmg",
                     asniperdefdmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.sniper.mindmg",
                     sniperdefdmg:GetValue())
        gui.SetValue("rbot.accuracy.weapon.lmg.mindmg", lmgdefdmg:GetValue())
    end

end)

-- 控制ui显示
callbacks.Register("Draw", function()
    pistoldefdmg:SetInvisible(true)
    pistoldefmindmg:SetInvisible(true)
    hpistoldefdmg:SetInvisible(true)
    hpistoldefmindmg:SetInvisible(true)
    smgdefdmg:SetInvisible(true)
    smgdefmindmg:SetInvisible(true)
    rifledefdmg:SetInvisible(true)
    rifledefmindmg:SetInvisible(true)
    shotgundefdmg:SetInvisible(true)
    shotgundefmindmg:SetInvisible(true)
    scoutdefdmg:SetInvisible(true)
    scoutdefmindmg:SetInvisible(true)
    asniperdefdmg:SetInvisible(true)
    asniperdefmindmg:SetInvisible(true)
    sniperdefdmg:SetInvisible(true)
    sniperdefmindmg:SetInvisible(true)
    lmgdefdmg:SetInvisible(true)
    lmgdefmindmg:SetInvisible(true)
    pistoldefhit:SetInvisible(true)
    pistoldefminhit:SetInvisible(true)
    hpistoldefhit:SetInvisible(true)
    hpistoldefminhit:SetInvisible(true)
    smgdefhit:SetInvisible(true)
    smgdefminhit:SetInvisible(true)
    rifledefhit:SetInvisible(true)
    rifledefminhit:SetInvisible(true)
    shotgundefhit:SetInvisible(true)
    shotgundefminhit:SetInvisible(true)
    scoutdefhit:SetInvisible(true)
    scoutdefminhit:SetInvisible(true)
    asniperdefhit:SetInvisible(true)
    asniperdefminhit:SetInvisible(true)
    sniperdefhit:SetInvisible(true)
    sniperdefminhit:SetInvisible(true)
    lmgdefhit:SetInvisible(true)
    lmgdefminhit:SetInvisible(true)
    if weaponCombobox:GetValue() == 0 then
        pistoldefdmg:SetInvisible(false)
        pistoldefmindmg:SetInvisible(false)
        pistoldefhit:SetInvisible(false)
        pistoldefminhit:SetInvisible(false)
    elseif weaponCombobox:GetValue() == 1 then
        hpistoldefdmg:SetInvisible(false)
        hpistoldefmindmg:SetInvisible(false)
        hpistoldefhit:SetInvisible(false)
        hpistoldefminhit:SetInvisible(false)
    elseif weaponCombobox:GetValue() == 2 then
        smgdefdmg:SetInvisible(false)
        smgdefmindmg:SetInvisible(false)
        smgdefhit:SetInvisible(false)
        smgdefminhit:SetInvisible(false)
    elseif weaponCombobox:GetValue() == 3 then
        rifledefdmg:SetInvisible(false)
        rifledefmindmg:SetInvisible(false)
        rifledefhit:SetInvisible(false)
        rifledefminhit:SetInvisible(false)
    elseif weaponCombobox:GetValue() == 4 then
        shotgundefdmg:SetInvisible(false)
        shotgundefmindmg:SetInvisible(false)
        shotgundefhit:SetInvisible(false)
        shotgundefminhit:SetInvisible(false)
    elseif weaponCombobox:GetValue() == 5 then
        scoutdefdmg:SetInvisible(false)
        scoutdefmindmg:SetInvisible(false)
        scoutdefhit:SetInvisible(false)
        scoutdefminhit:SetInvisible(false)
    elseif weaponCombobox:GetValue() == 6 then
        asniperdefdmg:SetInvisible(false)
        asniperdefmindmg:SetInvisible(false)
        asniperdefhit:SetInvisible(false)
        asniperdefminhit:SetInvisible(false)
    elseif weaponCombobox:GetValue() == 7 then
        sniperdefdmg:SetInvisible(false)
        sniperdefmindmg:SetInvisible(false)
        sniperdefhit:SetInvisible(false)
        sniperdefminhit:SetInvisible(false)
    elseif weaponCombobox:GetValue() == 8 then
        lmgdefdmg:SetInvisible(false)
        lmgdefmindmg:SetInvisible(false)
        lmgdefhit:SetInvisible(false)
        lmgdefminhit:SetInvisible(false)
    end

end)
------------------------antipeekeve start

local function antievmPeek() end

------------------------antipeekeve end
------------------------

local sld_minfov = gui.Slider(dynfovUI, "sld_minfov", "最小FOV", 5, 0, 15)
local sld_maxfov = gui.Slider(dynfovUI, "sld_maxfov", "最大FOV", 20, 0, 55)

local viewangles;

local function dynamicfov_logic()
    local pLocal = entities.GetLocalPlayer()

    if not chk_dynfov:GetValue() then return end
    if not pLocal then return end
    if not pLocal:GetAbsOrigin() then return end

    local dynamicfov_new_fov = gui.GetValue("rbot.aim.target.fov")
    local players = entities.FindByClass("CCSPlayer")
    local enemy_players = {}

    local min_fov = sld_minfov:GetValue()
    local max_fov = sld_maxfov:GetValue()

    if min_fov > max_fov then
        local store_min_fov = min_fov
        min_fov = max_fov
        max_fov = store_min_fov
    end

    for i = 1, #players do
        if players[i]:GetPropInt("m_iTeamNum") ~=
            entities.GetLocalPlayer():GetPropInt("m_iTeamNum") then
            table.insert(enemy_players, players[i])
        end
    end

    if #enemy_players ~= 0 then
        local own_hitbox = pLocal:GetHitboxPosition(0)
        local own_x, own_y, own_z = own_hitbox.x, own_hitbox.y, own_hitbox.z
        local own_pitch, own_yaw = viewangles.pitch, viewangles.yaw
        closest_enemy = nil
        local closest_distance = math.huge

        for i = 1, #enemy_players do
            local enemy = enemy_players[i]
            local enemy_x, enemy_y, enemy_z = enemy:GetHitboxPosition(0).x,
                                              enemy:GetHitboxPosition(0).y,
                                              enemy:GetHitboxPosition(0).z
            local x = enemy_x - own_x
            local y = enemy_y - own_y
            local z = enemy_z - own_z

            local yaw = (math.atan2(y, x) * 180 / math.pi)
            local pitch = -(math.atan2(z, math.sqrt(
                                           math.pow(x, 2) + math.pow(y, 2))) *
                              180 / math.pi)

            local yaw_dif = math.abs(own_yaw % 360 - yaw % 360) % 360
            local pitch_dif = math.abs(own_pitch - pitch) % 360

            if yaw_dif > 180 then yaw_dif = 360 - yaw_dif end

            local real_dif = math.sqrt(math.pow(yaw_dif, 2) +
                                           math.pow(pitch_dif, 2))

            if closest_distance > real_dif then
                closest_distance = real_dif
                closest_enemy = enemy
            end
        end

        if closest_enemy ~= nil then
            local closest_enemy_x, closest_enemy_y, closest_enemy_z =
                closest_enemy:GetHitboxPosition(0).x,
                closest_enemy:GetHitboxPosition(0).y,
                closest_enemy:GetHitboxPosition(0).z
            local real_distance = math.sqrt(
                                      math.pow(own_x - closest_enemy_x, 2) +
                                          math.pow(own_y - closest_enemy_y, 2) +
                                          math.pow(own_z - closest_enemy_z, 2))

            dynamicfov_new_fov = max_fov -
                                     ((max_fov - min_fov) *
                                         (real_distance - 250) / 1000)
        end
        if (dynamicfov_new_fov > max_fov) then
            dynamicfov_new_fov = max_fov
        elseif dynamicfov_new_fov < min_fov then
            dynamicfov_new_fov = min_fov
        end

        dynamicfov_new_fov = math.floor(dynamicfov_new_fov + 0.5)

        if (dynamicfov_new_fov > closest_distance) then
            bool_in_fov = true
        else
            bool_in_fov = false
        end
    else
        dynamicfov_new_fov = min_fov
        bool_in_fov = false
    end

    if dynamicfov_new_fov ~= old_fov then
        gui.SetValue("rbot.aim.target.fov", dynamicfov_new_fov)
    end
end

callbacks.Register("Draw", "dynfov", dynamicfov_logic)

callbacks.Register("Draw", function()
    sld_minfov:SetInvisible(not chk_dynfov:GetValue())
    sld_maxfov:SetInvisible(not chk_dynfov:GetValue())
end)

callbacks.Register("CreateMove",
                   function(cmd) viewangles = cmd:GetViewAngles() end)

---------------------fov绘制
callbacks.Register("Draw", function()
    if chk_dynfov:GetValue() then
        draw.Color(235, 77, 75)
        draw.Text(w / 2 - 20, h / 2 + 29, "FOV: ")
        draw.Color(246, 229, 141)
        draw.Text(w / 2 + 15, h / 2 + 29, gui.GetValue("rbot.aim.target.fov"))
    else

    end

end)

local autowallstats = true
---------------------auto开关
local function autopneandoff()
    if autowallstats then
        draw.Color(11, 232, 129)
        draw.Text(w / 2 - 20, h / 2 + 104, "AW")
    else
    end
    if QingheQInEMaxMOde ~= 0 then
        if input.IsButtonPressed(autowallkeybind:GetValue()) then
            autowallstat = not autowallstat
        end
    else

    end
    if QingheQInEMaxMOde == 0 then autowallstats = true end
    if autowallkeybind:GetValue() == nil then autowallstats = true end
    if autowallstat then
        autowallstats = false
    else
        autowallstats = true
    end
    gui.SetValue("rbot.hitscan.mode.scout.autowall", autowallstats)
    gui.SetValue("rbot.hitscan.mode.zeus.autowall", autowallstats)
    gui.SetValue("rbot.hitscan.mode.pistol.autowall", autowallstats)
    gui.SetValue("rbot.hitscan.mode.hpistol.autowall", autowallstats)
    gui.SetValue("rbot.hitscan.mode.smg.autowall", autowallstats)
    gui.SetValue("rbot.hitscan.mode.rifle.autowall", autowallstats)
    gui.SetValue("rbot.hitscan.mode.shotgun.autowall", autowallstats)
    gui.SetValue("rbot.hitscan.mode.asniper.autowall", autowallstats)
    gui.SetValue("rbot.hitscan.mode.sniper.autowall", autowallstats)
    gui.SetValue("rbot.hitscan.mode.lmg.autowall", autowallstats)
end
callbacks.Register("Draw", "autowallreg", autopneandoff)
---------------------

--------------------武器伤害覆盖

--------------------

---------------------AA指示器
function arrow()
    local AAinCSSr, AAinCSSl;
    if QInEmaxAAIndicatorsCSS:GetValue() == 0 then
        AAinCSSr = "<";
        AAinCSSl = ">";
    elseif QInEmaxAAIndicatorsCSS:GetValue() == 1 then
        AAinCSSl = ")";
        AAinCSSr = "(";
    elseif QInEmaxAAIndicatorsCSS:GetValue() == 2 then
        AAinCSSr = "丨";
        AAinCSSl = "丨";
    end
    local r = math.floor(math.sin(globals.RealTime() * 1) * 120 + 128);
    local g = math.floor(math.sin(globals.RealTime() * 1 + 2) * 120 + 128);
    local b = math.floor(math.sin(globals.RealTime() * 1 + 4) * 100 + 128);
    if not entities.GetLocalPlayer() or not entities.GetLocalPlayer():IsAlive() then
        return
    end
    if not gui.GetValue("rbot.master") then return end
    draw.SetFont(font)
    if CHECKBOX_ALL:GetValue() then
        if gui.GetValue("rbot.antiaim.base.rotation") > 0 then
            draw.Color(r, g, b, 255)
            draw.Text(w / 2 - 55 - 20, h / 2.05 - 5, AAinCSSr)
            draw.Text(w / 2 - 50, h / 2.05 - 5, "←")
        else
            draw.Color(r, g, b, 255)
            draw.Text(w / 2 + 30 + 20, h / 2.05 - 5, AAinCSSl)
            draw.Text(w / 2 + 20, h / 2.05 - 5, "→")
        end
    end

end
callbacks.Register("Draw", "semiragehelper", arrow)
callbacks.Register("Draw", function()
    local r = math.floor(math.sin(globals.RealTime() * 1) * 120 + 128);
    local g = math.floor(math.sin(globals.RealTime() * 1 + 2) * 120 + 128);
    local b = math.floor(math.sin(globals.RealTime() * 1 + 4) * 100 + 128);
    draw.Color(r, g, b, 255);
    draw.FilledRect(0, 0, x, 2.5);
end)
---------------------------默认RageAA方向
local rotationQInE = 58
local lbyQInE = 126
local aabase = 172;
function finverter()
    gui.SetValue("rbot.antiaim.advanced.pitch", 2)
    if KEYBOX_INVERTER:GetValue() ~= 0 then
        if input.IsButtonPressed(KEYBOX_INVERTER:GetValue()) then
            aabase = 172
            invrtr = not invrtr
        end
        if invrtr then

            gui.SetValue("rbot.antiaim.base", aabase)
            gui.SetValue("rbot.antiaim.base.rotation", rotationQInE)
            gui.SetValue("rbot.antiaim.base.lby", -lbyQInE)
        else

            gui.SetValue("rbot.antiaim.base", -aabase)
            gui.SetValue("rbot.antiaim.base.rotation", -rotationQInE)
            gui.SetValue("rbot.antiaim.base.lby", lbyQInE)
        end
    end

end
callbacks.Register("Draw", "semiragehelper", finverter)

-- 合法AA切换以及合法AA左右切换
function leftAAbot()
    local AAzt = false
    local r = math.floor(math.sin(globals.RealTime() * 1) * 120 + 128);
    local g = math.floor(math.sin(globals.RealTime() * 1 + 2) * 120 + 128);
    local b = math.floor(math.sin(globals.RealTime() * 1 + 4) * 100 + 128);
    draw.Color(186, 220, 88)
    draw.Text(w / 2 + 22, h / 2.05 + 15, "Max") -- 自定义准星下水印
    draw.Color(r, g, b)
    draw.Text(w / 2, h / 2.05 + 15, "Qln")
    if KEYBOX_start:GetValue() == 0 then
        if input.IsButtonDown(KEYBOX_ONUSEKEY:GetValue()) then -- 按下
            gui.SetValue("rbot.antiaim.advanced.pitch", off)
            draw.Color(0, 0, 0)
            draw.Text(w / 2, h / 2.05 + 30, "LegitAA")
            gui.SetValue("rbot.antiaim.base", 0)
            if invrtr then
                gui.SetValue("rbot.antiaim.base.rotation", rotationQInE)

            else
                gui.SetValue("rbot.antiaim.base.rotation", -rotationQInE)
            end
        else
            draw.Color(0, 0, 0)
            draw.Text(w / 2, h / 2.05 + 30, "RageAA") -- 显示当前AA模式
        end
    else
        if input.IsButtonPressed(KEYBOX_ONUSEKEY:GetValue()) then -- 按住
            onuse = not onuse
        end

        if onuse then
            draw.Color(0, 0, 0)
            draw.Text(w / 2, h / 2.05 + 30, "RageAA")
            lbyQInE = 126
        else
            gui.SetValue("rbot.antiaim.advanced.pitch", off)
            draw.Color(0, 0, 0)
            draw.Text(w / 2, h / 2.05 + 30, "LegitAA")
            lbyQInE = 85
            if invrtr then

                gui.SetValue("rbot.antiaim.base", 0)
                gui.SetValue("rbot.antiaim.base.rotation", -rotationQInE)
                gui.SetValue("rbot.antiaim.base.lby", lbyQInE)
            else

                gui.SetValue("rbot.antiaim.base", 0)
                gui.SetValue("rbot.antiaim.base.rotation", rotationQInE)
                gui.SetValue("rbot.antiaim.base.lby", -lbyQInE)
            end

        end
    end
end
callbacks.Register("Draw", "semiragehelper", leftAAbot)

---------------------合法&摇头模式切换

callbacks.Register("Draw", function()
    if QingheQInEMaxMOde:GetValue() ~= 0 then
        onuse = false
        autowallkeygui:SetActive(aw_menu:IsActive())
    else
        autowallkeygui:SetActive(false)
    end

end)

---------------------

-- 左藏头
function leftBot()

    if KEYBOX_LEFTKEY:GetValue() ~= 0 then
        if input.IsButtonPressed(KEYBOX_LEFTKEY:GetValue()) then
            left = not left
        end

        if left then
            aabase = 118
            gui.SetValue("rbot.antiaim.base", aabase)
            draw.Color(224, 86, 253)
            draw.Text(w / 2, h / 2.05 + 45, "<-左")
            right = false
            Back = false
        else
            aabase = 172
        end
    end
end
callbacks.Register("Draw", "LfetBotAA", leftBot)
-- 右藏头
function rightBot()

    if KEYBOX_RIGHTKEY:GetValue() ~= 0 then
        if input.IsButtonPressed(KEYBOX_RIGHTKEY:GetValue()) then
            right = not right
        end

        if right then
            left = false
            Back = false
            aabase = 75;
            gui.SetValue("rbot.antiaim.base", -aabase)
            draw.Color(224, 86, 253)
            draw.Text(w / 2, h / 2.05 + 45, "右->")
        else
            aabase = 172
        end
    end
end

callbacks.Register("Draw", "RightborAA", rightBot)

-- 背身AA
function BackBot()

    if KEYBOX_BackKEY:GetValue() ~= 0 then
        if input.IsButtonPressed(KEYBOX_BackKEY:GetValue()) then
            Back = not Back
        end

        if Back then
            right = false
            left = false
            aabase = 172
            gui.SetValue("rbot.antiaim.base", aabase)
            draw.Color(224, 86, 253)
            draw.Text(w / 2, h / 2.05 + 45, "背身")
        else

        end
    end
end

callbacks.Register("Draw", "semiragehelper", BackBot)

-- draw Weapon
local weaponapi = gui.Reference("Ragebot", "Accuracy", "Weapon")
local function ApiWeapon(var)
    local Weapon_selection = string.match(var, [["(.+)"]])
    if Weapon_selection == "Heavy Pistol" then
        Weapon_selection = "hpistol"
    elseif Weapon_selection == "Auto Sniper" then
        Weapon_selection = "asniper"
    elseif Weapon_selection == "Submachine Gun" then
        Weapon_selection = "Smg"
    elseif Weapon_selection == "Light Machine Gun" then
        Weapon_selection = "Lmg"
    end
    local Weapon = string.lower(Weapon_selection)
    return Weapon
end

callbacks.Register("Draw", function()
    local Weapon = gui.GetValue('rbot.accuracy.weapon')
    if Weapon == '"Sniper"' then
        Weapon = "AWP"
    elseif Weapon == '"Scout"' then
        Weapon = "Scout"
    elseif Weapon == '"Heavy Pistol"' then
        Weapon = "Heavy Pistol"
    elseif Weapon == '"Pistol"' then
        Weapon = "Pistol"
    elseif Weapon == '"Rifle"' then
        Weapon = "Rifle"
    elseif Weapon == '"Zeus"' then
        Weapon = "Zeus"
    elseif Weapon == '"Submachine Gun"' then
        Weapon = "SMG"
    elseif Weapon == '"Shotgun"' then
        Weapon = "SG"
    elseif Weapon == '"Light Machine Gun"' then
        Weapon = "LMG"
    elseif Weapon == '"Auto Sniper"' then
        Weapon = "Auto-SR"

    end
    if Qhweaponbox:GetValue() then
        draw.Color(0, 255, 255)
        draw.Text(w / 2 - 55, h / 2 - 55, "Weapon: ")
        draw.Color(225, 255, 255)
        draw.Text(w / 2 + 5, h / 2 - 55, Weapon)
        local Weapon3 = ApiWeapon(weaponapi:GetValue())
        if Weapon == "Auto-SR" then
            gui.SetValue("rbot.aim.automation.scope", 0)

        else
            gui.SetValue("rbot.aim.automation.scope", 2)

        end
        local mindmg = gui.GetValue("rbot.accuracy.weapon." .. Weapon3 ..
                                        ".mindmg")
        local hitchance = gui.GetValue("rbot.accuracy.weapon." .. Weapon3 ..
                                           ".hitchance")
        draw.Color(255, 121, 121)
        draw.Text(w / 2 + 5, h / 2 - 30, "DMG: ")
        draw.Color(246, 229, 141)
        draw.Text(w / 2 + 40, h / 2 - 30, mindmg)
        draw.Color(235, 77, 75)
        draw.Text(w / 2 - 55, h / 2 - 30, "HIT: ")
        draw.Color(246, 229, 141)
        draw.Text(w / 2 - 26, h / 2 - 30, hitchance)
    else
    end
end)
-- draw onshot
-- draw fake lag
-- draw Slowk

callbacks.Register("Draw", function()

    gui.SetValue("rbot.antiaim.advanced.antiresolver", false)
    local Slowk = gui.GetValue("rbot.accuracy.movement.slowkey")
    local rotationMath = math.random(-50, 50)
    local lbyMath = math.random(-50, 50)
    local factorMath = math.random(1, 5)
    -- local lbysum=math.floor(math.sin(globals.RealTime() * 1) * 150);
    if input.IsButtonDown(32) then
        gui.SetValue("rbot.antiaim.advanced.antiresolver", true)
        gui.SetValue('misc.fakelag.factor', factorMath + 3)
        gui.SetValue("rbot.antiaim.base.rotation", rotationMath)
        gui.SetValue("rbot.antiaim.base.lby", lbyMath)
        draw.Color(232, 65, 24);
        draw.Text(w / 2 - 20, h / 2 + 39, "AIR")
        -- end
    else
        if flmode:GetValue() == 0 then
            if dongtaifl:GetValue() == true then
                gui.SetValue('misc.fakelag.factor', factorMath)
                return
            end
            gui.SetValue('misc.fakelag.factor', math.random(4, 5))
        else
            if dongtaifl:GetValue() == true then
                gui.SetValue('misc.fakelag.factor', factorMath + 9)
                return
            end
            gui.SetValue('misc.fakelag.factor', math.random(10, 16))
        end

        -- if input.IsButtonDown(Slowk) then
        --         -- gui.SetValue("rbot.antiaim.advanced.antiresolver", true)
        --         print("1")

        -- else
        -- aabase=172
        -- lbyQInE=126
        -- rotationQInE=58
        -- end
    end
end)
callbacks.Register("Draw", function()
    local autopeekkeyyyy = gui.GetValue("rbot.accuracy.movement.autopeekkey")
    local Slowk = gui.GetValue("rbot.accuracy.movement.slowkey")
    local FakeLag = gui.GetValue('misc.fakelag.factor')
    local fakeduck = gui.GetValue("rbot.antiaim.extra.fakecrouchkey")
    local onshot = gui.GetValue("rbot.antiaim.condition.shiftonshot")

    if indfdswbox:GetValue() then
        if onshot then
            draw.Color(190, 46, 221)
            draw.Text(w / 2 - 20, h / 2 + 60, "Onshot")
        else
        end
        if input.IsButtonDown(autopeekkeyyyy) then
            draw.Color(68, 189, 50)
            draw.Text(w / 2 - 20, h / 2 + 70, "AuPeek")
        end
        draw.Color(37, 204, 247)
        draw.Text(w / 2 - 20, h / 2 + 50, "FL: " .. FakeLag)
        if input.IsButtonDown(fakeduck) then
            draw.Color(235, 77, 75)
            draw.Text(w / 2 - 20, h / 2 + 80, "FD")
        else

        end
        if input.IsButtonDown(Slowk) then
            draw.Color(235, 77, 75)
            draw.Text(w / 2 - 20, h / 2 + 70, "Slowk")
        end
    else

    end
end)

-- 绘制水印

ffi.cdef [[
    typedef struct _MEMORYSTATUSEX {
        unsigned long dwLength;
        unsigned long dwMemoryLoad;
        unsigned __int64 ullTotalPhys;
        unsigned __int64 ullAvailPhys;
        unsigned __int64 ullTotalPageFile;
        unsigned __int64 ullAvailPageFile;
        unsigned __int64 ullTotalVirtual;
        unsigned __int64 ullAvailVirtual;
        unsigned __int64 ullAvailExtendedVirtual;
    } MEMORYSTATUSEX, *LPMEMORYSTATUSEX;
    
    typedef struct _FILETIME {
        unsigned long dwLowDateTime;
        unsigned long dwHighDateTime;
    } FILETIME, *PFILETIME, *LPFILETIME;

    uint32_t GetSystemTimes(PFILETIME lpIdleTime , PFILETIME lpKernelTime , PFILETIME  lpUserTime );

    uint32_t GlobalMemoryStatusEx(LPMEMORYSTATUSEX);

    typedef void* (__cdecl* tCreateInterface)(const char* name, int* returnCode);
    void* GetProcAddress(void* hModule, const char* lpProcName);
    void* GetModuleHandleA(const char* lpModuleName);

]]
local leveltext = "null" -- 用户分组值
-- x/2+560, y/2-530cheat.GetUserName() 
-- local text2, text3, text4 = string.find(http.Get(
--     "http://49.234.105.252:975/user/level/userlevellist.txt"),"(".. QQIconCode ..")")
-- if  text2~=nil then--用户分组
leveltext = "User"
-- else
-- leveltext="Vip"

-- end
local frame_rate = 0.0
local fps = 0
callbacks.Register("Draw", function()
    frame_rate = 0.9 * frame_rate + (1.0 - 0.9) * globals.AbsoluteFrameTime()
    fps = math.floor((1.0 / frame_rate) + 0.5)
end)

-- CPU 和 RAM 部分借鉴了https://aimware.net/forum/thread/152542/page/1

local CPU = {CPU = 0, InterpolatedCPU = 0, last_getCPU = 0}
local RAM = {RAM = 1, InterpolatedRAM = 0, last_getRAM = 0}
local _previousTotalTicks, _previousIdleTicks, _oldRet = 0, 0, 0;
function CalculateCPULoad(idleTicks, totalTicks)

    totalTicksSinceLastTime = totalTicks - _previousTotalTicks;
    idleTicksSinceLastTime = idleTicks - _previousIdleTicks;

    if totalTicksSinceLastTime > 0 then
        ret = 100 - (100 * idleTicksSinceLastTime / totalTicksSinceLastTime) + 1
    end
    _previousTotalTicks = totalTicks;
    _previousIdleTicks = idleTicks;

    if ret and ret > 0 and ret < 100 then _oldRet = ret end
    return _oldRet;

end

local function cpu()

    if (globals.RealTime() - CPU.last_getCPU > 0.2) then
        local idleTime = ffi.new('FILETIME')
        local kernelTime = ffi.new('FILETIME')
        local userTime = ffi.new('FILETIME')
        ffi.C.GetSystemTimes(idleTime, kernelTime, userTime)
        local idleTimeint64 = bit.bxor(bit.rshift(idleTime.dwHighDateTime, 32),
                                       idleTime.dwLowDateTime)
        local kernelTimeint64 = bit.bxor(
                                    bit.rshift(kernelTime.dwHighDateTime, 32),
                                    kernelTime.dwLowDateTime)
        local userTimeint64 = bit.bxor(bit.rshift(userTime.dwHighDateTime, 32),
                                       userTime.dwLowDateTime)

        CPU.CPU = CalculateCPULoad(idleTimeint64,
                                   kernelTimeint64 + userTimeint64)
        CPU.last_getCPU = globals.RealTime();
    end
    if CPU.CPU > CPU.InterpolatedCPU then
        if CPU.CPU - CPU.InterpolatedCPU >= 1 then
            if CPU.CPU ~= CPU.InterpolatedCPU then
                CPU.InterpolatedCPU = CPU.InterpolatedCPU + 0.1
            end
        end
    elseif CPU.CPU < CPU.InterpolatedCPU then
        if CPU.CPU - CPU.InterpolatedCPU <= 1 then
            if CPU.CPU ~= CPU.InterpolatedCPU then
                CPU.InterpolatedCPU = CPU.InterpolatedCPU - 0.1
            end
        end
    end
    return InterpolatedCPU
end
local function ram()

    if (globals.RealTime() - RAM.last_getRAM > 1) then
        MEMORYSTATUSEX = ffi.new('MEMORYSTATUSEX')
        MEMORYSTATUSEX.dwLength = ffi.sizeof(MEMORYSTATUSEX)
        ffi.C.GlobalMemoryStatusEx(MEMORYSTATUSEX)
        RAM.RAM = MEMORYSTATUSEX.dwMemoryLoad
        RAM.last_getRAM = globals.RealTime();
    end
    if RAM.RAM > RAM.InterpolatedRAM then
        if RAM.RAM - RAM.InterpolatedRAM >= 1 then
            if RAM.RAM ~= RAM.InterpolatedRAM then
                RAM.InterpolatedRAM = RAM.InterpolatedRAM + 0.1
            end
        end
    elseif RAM.RAM < RAM.InterpolatedRAM then
        if RAM.RAM ~= RAM.InterpolatedRAM then
            RAM.InterpolatedRAM = RAM.InterpolatedRAM - 0.1
        end
    end
    return RAM.InterpolatedRAM
end
local fontttf = draw.AddFontResource("SourceHanSansCN-Normal.otf")
local TOPFONT = draw.CreateFont("SourceHanSansCN-Normal", 16, 450)
local BOTFONT = draw.CreateFont("SourceHanSansCN-Normal", 20, 750)

local delay = "0" -- 延迟
local RGBA, width, height = common.DecodeJPEG(iconPng);
local texture = draw.CreateTexture(RGBA, width, height)
local bcPng = http.Get(
                  "http://1256182033.vod2.myqcloud.com/7d2fb881vodcq1256182033/4a413f283701925921929930543/8jjGCuUW7fAA.png")
local RGBA, width, height = common.DecodePNG(bcPng);
local bcPngvv = draw.CreateTexture(RGBA, width, height)

callbacks.Register("Draw", function()
    cpu()
    ram()
    local tickccc = globals.TickCount() / globals.CurTime()
    local r = math.floor(math.sin(globals.RealTime() * 1) * 120 + 128);
    local g = math.floor(math.sin(globals.RealTime() * 1 + 2) * 120 + 128);
    local b = math.floor(math.sin(globals.RealTime() * 1 + 4) * 100 + 128);
    -- math.ceil(CPU.InterpolatedCPU)  cpu占用
    -- math.ceil(RAM.InterpolatedRAM)  ram占用
    local cpur, cpug, cpub, ramr, ramg, ramb;
    if CPU.InterpolatedCPU < 40 then
        cpur = 46;
        cpug = 213;
        cpub = 115;
    elseif CPU.InterpolatedCPU > 40 and CPU.InterpolatedCPU < 70 then
        cpur = 255;
        cpug = 99;
        cpub = 72;
    elseif CPU.InterpolatedCPU > 70 and CPU.InterpolatedCPU < 100 then
        cpur = 234;
        cpug = 32;
        cpub = 39;
    end
    if RAM.InterpolatedRAM < 40 then
        ramr = 46;
        ramg = 213;
        ramb = 115;
    elseif RAM.InterpolatedRAM > 40 and RAM.InterpolatedRAM < 70 then
        ramr = 255;
        ramg = 99;
        ramb = 72;
    elseif RAM.InterpolatedRAM > 70 and RAM.InterpolatedRAM < 100 then
        ramr = 234;
        ramg = 32;
        ramb = 39;
    end
    if entities.GetLocalPlayer() ~= nil then
        local pr = entities.GetPlayerResources()
        delay = pr:GetPropInt("m_iPing", entities.GetLocalPlayer():GetIndex())
    else
        delay = "0"
    end
    if QInEMaxWatermark:GetValue() then
        draw.SetTexture(bcPngvv)
        draw.FilledRect(x / 2 + 535, y / 2 - 515, x / 2 + 935, y / 2 - 415)
        draw.SetTexture(texture)
        draw.FilledRect(x / 2 + 546, y / 2 - 504, x / 2 + 624, y / 2 - 428)
        draw.Color(255, 255, 255)
        draw.SetFont(TOPFONT)
        draw.TextShadow(x / 2 + 783, y / 2 - 498, QQIconCode)
        draw.Color(255, 255, 255)
        draw.TextShadow(x / 2 + 902, y / 2 - 498, leveltext)
        draw.SetFont(BOTFONT)
        draw.Color(0, 0, 0)
        draw.TextShadow(x / 2 + 715, y / 2 - 468, delay .. " ms")
        draw.TextShadow(x / 2 + 705, y / 2 - 437, fps)
        draw.TextShadow(x / 2 + 817, y / 2 - 468, math.ceil(tickccc))
        draw.Color(0, 0, 0)
        draw.TextShadow(x / 2 + 779, y / 2 - 437, os.date('%X'))
        draw.Color(cpur, cpug, cpub, 160)
        draw.TextShadow(x / 2 + 902, y / 2 - 468,
                        math.ceil(CPU.InterpolatedCPU) .. "%")
        draw.Color(ramr, ramg, ramb, 160)
        draw.TextShadow(x / 2 + 902, y / 2 - 437,
                        math.ceil(RAM.InterpolatedRAM) .. "%")
    end
end)
-- 水印END
-- 组名 mian

callbacks.Register("Draw", function()
    local curtime = math.floor(globals.CurTime() * 2.1);
    if entities.GetLocalPlayer() == nil then return; end
    if customtag:GetValue() then
        if customtaglist:GetValue() == 0 then
            if old_time ~= curtime then
                QInEMaxSetTagfun(cconeQinghe[curtime % #cconeQinghe + 1],
                                 cconeQinghe[curtime % #cconeQinghe + 1]);
            end
            old_time = curtime;
    else
        QInEMaxSetTagfun("QInE")
    end
    end
end)
-- 组名 END
callbacks.Register("Draw", function()
    local Weapon2 = ApiWeapon(weaponapi:GetValue())
    if Weapon2 == "zeus" then return end
    local dt_wap = gui.GetValue("rbot.accuracy.weapon." .. Weapon2 ..
                                    ".doublefire")
    if dt_wap == 0 then

    else
        draw.Color(255, 165, 2)
        draw.Text(w / 2 - 20, h / 2 + 90, "DT")
    end
end)
local activeHitLogs = {};
local function HitGroup(INT_HITGROUP)
    if INT_HITGROUP == nil then
        return;
    elseif INT_HITGROUP == 0 then
        return "身体";
    elseif INT_HITGROUP == 1 then
        return "脑瓜子";
    elseif INT_HITGROUP == 2 then
        return "胸部";
    elseif INT_HITGROUP == 3 then
        return "腹部";
    elseif INT_HITGROUP == 4 then
        return "左臂";
    elseif INT_HITGROUP == 5 then
        return "右臂";
    elseif INT_HITGROUP == 6 then
        return "左腿";
    elseif INT_HITGROUP == 7 then
        return "右腿";
    elseif INT_HITGROUP == 10 then
        return "身体";
    end
end

local function add(time, ...)
    local speed = 1.5
    local r = math.floor(math.sin(globals.RealTime() * speed) * 120 + 130)
    local g = math.floor(math.sin(globals.RealTime() * speed + 2) * 120 + 130)
    local b = math.floor(math.sin(globals.RealTime() * speed + 4) * 120 + 130)
    table.insert(activeHitLogs, {
        ["text"] = {...},
        ["time"] = time,
        ["delay"] = globals.RealTime() + time,
        ["color"] = {{r, g, b}, {16, 0, 0}},
        ["x_pad"] = -11,
        ["x_pad_b"] = -11
    })
end

local function getMultiColorTextSize(lines)
    local fw = 0
    local fh = 0;
    for i = 1, #lines do
        local w, h = draw.GetTextSize(lines[i][4])
        fw = fw + w
        fh = h;
    end
    return fw, fh
end
local c_hud_chat = ffi.cast("unsigned long(__thiscall*)(void*, const char*)",
                            mem.FindPattern("client.dll",
                                            "55 8B EC 53 8B 5D 08 56 57 8B F9 33 F6 39 77 28"))(
                       ffi.cast("unsigned long**",
                                ffi.cast("uintptr_t",
                                         mem.FindPattern("client.dll",
                                                         "B9 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 5D 08")) +
                                    1)[0], "CHudChat")
local ffi_print_chat = ffi.cast(
                           "void(__cdecl*)(int, int, int, const char*, ...)",
                           ffi.cast("void***", c_hud_chat)[0][27])
function client.PrintChat(msg) ffi_print_chat(c_hud_chat, 0, 0, " " .. msg) end

local function drawMultiColorText(x, y, lines)
    local x_pad = 0
    for i = 1, #lines do
        local line = lines[i];
        local r, g, b, msg = line[1], line[2], line[3], line[4]
        draw.Color(r, g, b, 255);
        draw.Text(x + x_pad, y, msg);
        local w, _ = draw.GetTextSize(msg)
        x_pad = x_pad + w
    end
end

local function showLog(count, color, text, layer)
    local y = 15 + (42 * (count - 1));
    local w, h = getMultiColorTextSize(text)
    local mw = w < 150 and 150 or w
    if globals.RealTime() < layer.delay then
        if layer.x_pad < mw then
            layer.x_pad = layer.x_pad + (mw - layer.x_pad) * 0.05
        end
        if layer.x_pad > mw then layer.x_pad = mw end
        if layer.x_pad > mw / 1.09 then
            if layer.x_pad_b < mw - 6 then
                layer.x_pad_b = layer.x_pad_b + ((mw - 6) - layer.x_pad_b) *
                                    0.05
            end
        end
        if layer.x_pad_b > mw - 6 then layer.x_pad_b = mw - 6 end
    else
        if layer.x_pad_b > -11 then
            layer.x_pad_b =
                layer.x_pad_b - (((mw - 5) - layer.x_pad_b) * 0.05) + 0.01
        end
        if layer.x_pad_b < (mw - 11) and layer.x_pad >= 0 then
            layer.x_pad = layer.x_pad - (((mw + 1) - layer.x_pad) * 0.05) + 0.01
        end
        if layer.x_pad < 0 then table.remove(activeHitLogs, count) end
    end
    local c1 = color[1]
    local c2 = color[2]
    local a = 255;
    draw.Color(c1[1], c1[2], c1[3], a);
    draw.FilledRect(layer.x_pad - layer.x_pad, y, layer.x_pad + 28, (h + y) + 20);
    draw.Color(c2[1], c2[2], c2[3], a);
    draw.FilledRect(layer.x_pad_b - layer.x_pad, y, layer.x_pad_b + 22,
                    (h + y) + 20);
    drawMultiColorText(layer.x_pad_b - mw + 18, y + 9, text)
end

callbacks.Register('FireGameEvent', function(e)
    local en = e:GetName();
    -- print(en)

    local playerDeath = en == 'player_death'
    local isHurt = en == 'player_hurt';
    local weaponFired = en == 'weapon_fire';
    if isHurt == false and weaponFired == false then return end
    local localPlayer = entities.GetLocalPlayer();
    local user = entities.GetByUserID(e:GetInt('userid'));
    local attacker = entities.GetByUserID(e:GetInt('attacker'));
    local ME = client.GetLocalPlayerIndex();
    local INT_UID = e:GetInt('userid');
    local INT_ATTACKER = e:GetInt('attacker');
    local INDEX_Attacker = client.GetPlayerIndexByUserID(INT_ATTACKER);
    local INDEX_Victim = client.GetPlayerIndexByUserID(INT_UID);

    if (localPlayer == nil or user == nil) then return; end
    if isHurt then
        local remainingHealth = e:GetInt('health');
        local damageDone = e:GetInt('dmg_health');
        if (attacker == nil) then return; end
        if (localPlayer:GetIndex() == attacker:GetIndex()) then
            if Checkbox_SHOTeve:GetValue() == true then
                invrtr = not invrtr
            end

            if remainingHealth == 0 and Checkbox_KILLEVENT:GetValue() == true then
                if right then
                    right = false
                    left = true
                    Back = false
                    return
                end
                if left then
                    left = false
                    right = true
                    Back = false
                    return
                end
                if gui.GetValue("rbot.antiaim.base.rotation") > 0 then
                    right = true
                    left = false
                    Back = false
                else
                    Back = false
                    left = true
                    right = false
                end
            end
            local r = math.floor(math.sin(globals.RealTime() * 1) * 100 + 127);
            local g = math.floor(math.sin(globals.RealTime() * 1 + 2) * 100 +
                                     127);
            local b = math.floor(math.sin(globals.RealTime() * 1 + 4) * 100 +
                                     127);

            local msg = client.GetConVar('name') .. " 击中了 " ..
                            user:GetName() .. " 的 " ..
                            HitGroup(e:GetInt('hitgroup')) .. " 造成 " ..
                            damageDone .. " 的伤害 ( 剩余 " ..
                            remainingHealth .. " 的血量 ) ";
            if masg:GetValue() == true then
                client.PrintChat("\01[\02𝑸𝒊𝒏𝒈𝒉𝒆'V5\01] " ..
                                     msg .. "\n")
            else
                add(5, {r, g, b, "[𝑸𝒊𝒏𝒈𝒉𝒆'V5] "},
                    {255, 255, 255, " 击中了 "},
                    {r, g, b, string.sub(user:GetName(), 0, 28)},
                    {255, 255, 255, " 的 "},
                    {30, 144, 255, HitGroup(e:GetInt('hitgroup'))},
                    {255, 255, 255, " 造成 "}, {220, 20, 60, damageDone},
                    {255, 255, 255, " 的伤害 (剩余 "},
                    {139, 0, 139, remainingHealth},
                    {255, 255, 255, " 的血量 )"});
            end
            if masgsay:GetValue() then
                client.ChatSay(msg)
            else
            end
        end
    elseif weaponFired then

        -- gui.SetValue( "rbot.antiaim.base.rotation", -(gui.GetValue( "rbot.antiaim.base.rotation" )) )
        -- gui.SetValue( "rbot.antiaim.base.lby", -(gui.GetValue( "rbot.antiaim.base.lby" )) )

        -- if (localPlayer:GetIndex() == user:GetIndex() and target ~= nil) then
        --     -- todo implement miss shots
        --     print("weaponFired")

        -- end
    end
    -- local function shotEvent()
    --     if weaponFired and Checkbox_SHOTeve:GetValue() == true then
    --         if KEYBOX_shotstat:GetValue() == 0 then
    --             if (user:GetIndex() ~= attacker:GetIndex() and user:GetIndex() ~=
    --                 localPlayer:GetIndex()) then
    --                     gui.SetValue("rbot.antiaim.base.rotation",
    --                     -(gui.GetValue("rbot.antiaim.base.rotation")))
    --                     gui.SetValue("rbot.antiaim.base.lby",
    --                     -(gui.GetValue("rbot.antiaim.base.lby")))
    --             end
    --             else

    --         end
    --     end
    -- end
    -- callbacks.Register("Draw", "semiragehelper", shotEvent)
end);

callbacks.Register("Draw", function()
    for index, hitlog in pairs(activeHitLogs) do
        showLog(index, hitlog.color, hitlog.text, hitlog)
    end
end);
